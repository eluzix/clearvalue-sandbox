if __name__ == '__main__':
    data = []
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.011857748031616211}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011296510696411133}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011688947677612305}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 3.0517578125e-05}, {'method': 'load_securities', 'name': 'batch_get_items', 'time': 0.010202884674072266}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 2.8848648071289062e-05}, {'method': 'load_securities', 'name': 'batch_get_items', 'time': 0.011748313903808594}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 6.175041198730469e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 0.010279178619384766}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 0.010286569595336914}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 0.011829614639282227}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 0.011836767196655273}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 2.5033950805664062e-05}, {'method': 'load_securities', 'name': 'batch_get_items', 'time': 0.006895542144775391}, {'method': 'load_securities', 'name': 'worldtradingdata.symbols_data', 'time': 0.44141530990600586}, {'method': 'load_securities', 'name': 'worldtradingdata.symbol_history', 'time': 0.4509880542755127}, {'method': 'load_securities', 'name': 'query < SortKey', 'time': 0.047603607177734375}, {'method': 'load_securities', 'name': 'SortKey begins_with', 'time': 0.0063018798828125}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 3.981590270996094e-05}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 5.602836608886719e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 0.9532921314239502}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 0.9533007144927979}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 7.05718994140625e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 7.653236389160156e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.6927719116210938e-05}, {'method': 'load_securities', 'name': 'batch_get_items', 'time': 0.007860422134399414}, {'method': 'load_securities', 'name': 'worldtradingdata.symbols_data', 'time': 0.4564943313598633}, {'method': 'load_securities', 'name': 'worldtradingdata.symbol_history', 'time': 0.4121589660644531}, {'method': 'load_securities', 'name': 'query < SortKey', 'time': 0.005376577377319336}, {'method': 'load_securities', 'name': 'SortKey begins_with', 'time': 0.0054302215576171875}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 3.62396240234375e-05}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 4.744529724121094e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 0.887404203414917}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 0.8874132633209229}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 6.437301635742188e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 7.05718994140625e-05}])
    data.extend([{'method': 'calculate_portfolio_daily', 'name': 'load_account_holdings', 'time': 0.007417917251586914}, {'method': 'calculate_portfolio_daily', 'name': 'building SecurityHoldings', 'time': 4.124641418457031e-05}, {'method': 'calculate_portfolio_daily', 'name': 'daily build_securities_portfolio', 'time': 0.022405147552490234}, {'method': 'calculate_portfolio_daily', 'name': '90 days build_securities_portfolio', 'time': 0.9536154270172119}, {'method': 'calculate_portfolio_daily', 'name': 'ytd build_securities_portfolio', 'time': 0.8877129554748535}, {'method': 'calculate_portfolio_daily', 'name': 'SecuritiesPortfolio value + score', 'time': 3.910064697265625e-05}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.012001991271972656}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011600494384765625}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011448144912719727}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 2.4080276489257812e-05}, {'method': 'load_securities', 'name': 'batch_get_items', 'time': 0.00614619255065918}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 2.6941299438476562e-05}, {'method': 'load_securities', 'name': 'batch_get_items', 'time': 0.005734682083129883}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 2.9802322387695312e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 0.0062177181243896484}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 0.006222724914550781}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 0.0058023929595947266}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 0.005806446075439453}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 2.1696090698242188e-05}, {'method': 'load_securities', 'name': 'batch_get_items', 'time': 0.005506753921508789}, {'method': 'load_securities', 'name': 'worldtradingdata.symbols_data', 'time': 0.44631028175354004}, {'method': 'load_securities', 'name': 'worldtradingdata.symbol_history', 'time': 0.46210312843322754}, {'method': 'load_securities', 'name': 'query < SortKey', 'time': 0.005440473556518555}, {'method': 'load_securities', 'name': 'SortKey begins_with', 'time': 0.005414485931396484}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 3.147125244140625e-05}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 2.8371810913085938e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 0.9248554706573486}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 0.9248602390289307}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 5.125999450683594e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 5.459785461425781e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.5020370483398438e-05}, {'method': 'load_securities', 'name': 'batch_get_items', 'time': 0.005519390106201172}, {'method': 'load_securities', 'name': 'worldtradingdata.symbols_data', 'time': 0.45355677604675293}, {'method': 'load_securities', 'name': 'worldtradingdata.symbol_history', 'time': 0.42258787155151367}, {'method': 'load_securities', 'name': 'query < SortKey', 'time': 0.005446910858154297}, {'method': 'load_securities', 'name': 'SortKey begins_with', 'time': 0.0054891109466552734}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 3.2901763916015625e-05}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 3.0517578125e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 0.8926849365234375}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 0.8926906585693359}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 6.222724914550781e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 6.580352783203125e-05}])
    data.extend([{'method': 'calculate_portfolio_daily', 'name': 'load_account_holdings', 'time': 0.0064237117767333984}, {'method': 'calculate_portfolio_daily', 'name': 'building SecurityHoldings', 'time': 2.8133392333984375e-05}, {'method': 'calculate_portfolio_daily', 'name': 'daily build_securities_portfolio', 'time': 0.012220621109008789}, {'method': 'calculate_portfolio_daily', 'name': '90 days build_securities_portfolio', 'time': 0.9251480102539062}, {'method': 'calculate_portfolio_daily', 'name': 'ytd build_securities_portfolio', 'time': 0.8929665088653564}, {'method': 'calculate_portfolio_daily', 'name': 'SecuritiesPortfolio value + score', 'time': 2.7179718017578125e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 3.457069396972656e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.6450881958007812e-05}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 4.5299530029296875e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 0.00010251998901367188}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 0.00010895729064941406}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 4.458427429199219e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 5.0067901611328125e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.7404556274414062e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.3828277587890625e-05}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 3.0994415283203125e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 4.792213439941406e-05}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 5.364418029785156e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 3.814697265625e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 4.1961669921875e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.5735626220703125e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.33514404296875e-05}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 2.765655517578125e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 4.4345855712890625e-05}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 4.982948303222656e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 3.719329833984375e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 4.0531158447265625e-05}])
    data.extend([{'method': 'calculate_portfolio_daily', 'name': 'load_account_holdings', 'time': 0.0077855587005615234}, {'method': 'calculate_portfolio_daily', 'name': 'building SecurityHoldings', 'time': 4.0531158447265625e-05}, {'method': 'calculate_portfolio_daily', 'name': 'daily build_securities_portfolio', 'time': 0.00039124488830566406}, {'method': 'calculate_portfolio_daily', 'name': '90 days build_securities_portfolio', 'time': 0.00024080276489257812}, {'method': 'calculate_portfolio_daily', 'name': 'ytd build_securities_portfolio', 'time': 0.00022530555725097656}, {'method': 'calculate_portfolio_daily', 'name': 'SecuritiesPortfolio value + score', 'time': 2.86102294921875e-05}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.01163482666015625}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011301517486572266}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011725902557373047}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 2.6464462280273438e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.2159347534179688e-05}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 2.8133392333984375e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 8.273124694824219e-05}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 8.678436279296875e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 2.8371810913085938e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 3.123283386230469e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.3113021850585938e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 0.00011658668518066406}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 1.6450881958007812e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 3.886222839355469e-05}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 4.1961669921875e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 0.0001392364501953125}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 0.0001423358917236328}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 1.2159347534179688e-05}])
    data.extend([{'method': 'load_securities', 'name': '_local_securities_cache', 'time': 9.775161743164062e-06}])
    data.extend([{'method': 'build_securities_portfolio', 'name': 'init', 'time': 1.7881393432617188e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 1', 'time': 3.695487976074219e-05}, {'method': 'build_securities_portfolio', 'name': 'since_date setup', 'time': 4.00543212890625e-05}, {'method': 'build_securities_portfolio', 'name': 'load_securities 2', 'time': 2.8848648071289062e-05}, {'method': 'build_securities_portfolio', 'name': 'items setup', 'time': 3.0994415283203125e-05}])
    data.extend([{'method': 'calculate_portfolio_daily', 'name': 'load_account_holdings', 'time': 0.0059814453125}, {'method': 'calculate_portfolio_daily', 'name': 'building SecurityHoldings', 'time': 2.4557113647460938e-05}, {'method': 'calculate_portfolio_daily', 'name': 'daily build_securities_portfolio', 'time': 0.0003006458282470703}, {'method': 'calculate_portfolio_daily', 'name': '90 days build_securities_portfolio', 'time': 0.0003113746643066406}, {'method': 'calculate_portfolio_daily', 'name': 'ytd build_securities_portfolio', 'time': 0.00016951560974121094}, {'method': 'calculate_portfolio_daily', 'name': 'SecuritiesPortfolio value + score', 'time': 2.288818359375e-05}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.015885591506958008}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011032342910766602}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011501312255859375}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.011371850967407227}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.019037723541259766}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011443138122558594}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.011335611343383789}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011778116226196289}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011250972747802734}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.012187957763671875}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011054277420043945}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011393547058105469}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.01130366325378418}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.010841131210327148}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011031866073608398}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.011512041091918945}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011099100112915039}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011026859283447266}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.011474609375}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011260747909545898}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011576652526855469}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.011000394821166992}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011117219924926758}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.011362075805664062}])
    data.extend([{'method': 'calculate_value_account_daily', 'name': 'yesterday calculate_value_account', 'time': 0.010727643966674805}, {'method': 'calculate_value_account_daily', 'name': '90days calculate_value_account', 'time': 0.011453628540039062}, {'method': 'calculate_value_account_daily', 'name': 'ytd calculate_value_account', 'time': 0.012199163436889648}])
    data.extend([{'method': 'calculate_user_daily', 'name': 'init', 'time': 2.3126602172851562e-05}, {'method': 'calculate_user_daily', 'name': 'load_user_accounts', 'time': 0.05673098564147949}, {'method': 'calculate_user_daily', 'name': 'all accounts calc', 'time': 4.147979736328125}, {'method': 'calculate_user_daily', 'name': 'GNR', 'time': 6.198883056640625e-06}, {'method': 'calculate_user_daily', 'name': 'assets gnr', 'time': 6.389617919921875e-05}, {'method': 'calculate_user_daily', 'name': 'accounts db update', 'time': 0.12182927131652832}, {'method': 'calculate_user_daily', 'name': 'batch db update', 'time': 0.019901275634765625}])

    full_data = {}
    for elem in data:
        method = elem['method']
        method_data = full_data.get(method, {'count': 0, 'total': 0, 'names': {}})
        method_data['count'] += 1
        method_data['total'] += elem['time']

        name_data = method_data['names'].get(elem['name'], {'count': 0, 'total': 0})
        name_data['count'] += 1
        name_data['total'] += elem['time']
        method_data['names'][elem['name']] = name_data

        full_data[method] = method_data

    for method_name in full_data:
        method_data = full_data[method_name]
        print('{} - total: {}, count: {}, avg: {}'.format(method_name, method_data['total'], method_data['count'], (method_data['total']/method_data['count'])))

        for name in method_data['names']:
            name_data = method_data['names'][name]
            print('     {} - total: {}, count: {}, avg: {}'.format(name, name_data['total'], name_data['count'], (name_data['total']/name_data['count'])))
